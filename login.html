<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Favicon package generated by Favicon.im Generator -->
<link rel="icon" type="image/x-icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="192x192" href="/android-chrome-192x192.png">
<link rel="icon" type="image/png" sizes="512x512" href="/android-chrome-512x512.png">
<meta name="theme-color" content="#ffffff">
    <title>Cadastro - Nzila Hub</title>
 <style>
        :root {
            --primary: #1a237e;
            --primary-light: #534bae;
            --secondary: #311b92;
            --success: #00c853;
            --success-light: #5efc82;
            --success-gradient: linear-gradient(135deg, #00c853 0%, #64dd17 100%);
            --danger: #f44336;
            --warning: #ff9800;
            --warning-gradient: linear-gradient(135deg, #FF9800 0%, #FFB74D 100%);
            --warning-light: #ffb74d;
            --info: #2196F3;
            --info-gradient: linear-gradient(135deg, #2196F3 0%, #1976D2 100%);
            --dark: #121212;
            --dark-card: #1e1e1e;
            --light: #f8f9fa;
            --gray: #757575;
            --gray-light: #b0b0b0;
            --white: #ffffff;
            --gradient-primary: linear-gradient(135deg, #1a237e 0%, #311b92 100%);
            --gradient-warning: linear-gradient(135deg, #FF9800 0%, #FFB74D 100%);
            --gradient-success: linear-gradient(135deg, #00c853 0%, #64dd17 100%);
            --gradient-danger: linear-gradient(135deg, #f44336 0%, #d32f2f 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        body {
            background: var(--gradient-primary);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 20% 80%, rgba(255, 152, 0, 0.1) 0%, transparent 50%),
                       radial-gradient(circle at 80% 20%, rgba(26, 35, 126, 0.1) 0%, transparent 50%);
            z-index: 0;
            animation: float 8s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translate(0px, 0px); }
            25% { transform: translate(10px, 10px); }
            50% { transform: translate(0px, 20px); }
            75% { transform: translate(-10px, 10px); }
        }

        .container {
            width: 100%;
            max-width: 450px;
            z-index: 1;
            animation: slideUp 0.8s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .logo {
            text-align: center;
            margin-bottom: 30px;
            animation: fadeIn 1s ease-out 0.2s both;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .logo h1 {
            color: var(--white);
            font-size: 2rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 8px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            font-weight: 700;
        }

        .logo h1 i {
            color: var(--warning-light);
            font-size: 2.2rem;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }

        .logo p {
            color: rgba(255,255,255,0.9);
            font-size: 1rem;
            font-weight: 400;
        }

        .bonus-badge {
            background: var(--gradient-warning);
            color: var(--white);
            padding: 15px 25px;
            border-radius: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin: 15px auto 30px;
            font-weight: 700;
            animation: pulse 2s infinite;
            max-width: 350px;
            box-shadow: 0 10px 30px rgba(255, 152, 0, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
        }

        .bonus-badge::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            right: -50%;
            bottom: -50%;
            background: linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.1) 100%);
            animation: rotate 20s linear infinite;
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .bonus-badge i {
            font-size: 1.4rem;
            position: relative;
            z-index: 1;
        }

        .bonus-badge span {
            position: relative;
            z-index: 1;
        }

        .card {
            background: var(--dark-card);
            border-radius: 24px;
            padding: 35px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.4);
            animation: slideUp 0.6s ease-out 0.2s both;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-warning);
        }

        .form-title {
            color: var(--white);
            margin-bottom: 30px;
            text-align: center;
            font-size: 1.6rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            font-weight: 700;
        }

        .form-title i {
            background: var(--gradient-warning);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .form-container {
            display: block;
        }

        .form-group {
            margin-bottom: 25px;
            animation: slideInLeft 0.5s ease-out;
        }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            color: var(--gray-light);
            font-weight: 600;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .form-group label i {
            color: var(--warning-light);
            font-size: 0.9rem;
        }

        .form-group label span.optional {
            color: var(--gray);
            font-weight: normal;
            font-size: 12px;
            margin-left: auto;
        }

        .input-with-icon {
            position: relative;
        }

        .input-with-icon i {
            position: absolute;
            left: 18px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--warning-light);
            font-size: 1.1rem;
        }

        .input-with-icon input {
            width: 100%;
            padding: 16px 16px 16px 50px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s;
            color: var(--white);
            font-weight: 500;
        }

        .input-with-icon input:focus {
            border-color: var(--warning);
            outline: none;
            background: rgba(255, 255, 255, 0.08);
            box-shadow: 0 0 0 3px rgba(255, 152, 0, 0.2);
        }

        .input-with-icon input::placeholder {
            color: var(--gray);
        }

        .password-rules {
            font-size: 12px;
            color: var(--gray-light);
            margin-top: 8px;
            display: block;
            padding-left: 10px;
        }

        .submit-btn {
            width: 100%;
            padding: 18px;
            background: var(--gradient-warning);
            color: var(--white);
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            position: relative;
            overflow: hidden;
        }

        .submit-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.1) 100%);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .submit-btn:hover::before {
            opacity: 1;
        }

        .submit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(255, 152, 0, 0.4);
        }

        .submit-btn:disabled {
            background: var(--gray);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .submit-btn i {
            font-size: 1.1rem;
            position: relative;
            z-index: 1;
        }

        .submit-btn span {
            position: relative;
            z-index: 1;
        }

        .toggle-form {
            text-align: center;
            margin-top: 25px;
            color: var(--gray-light);
            font-size: 14px;
        }

        .toggle-form a {
            color: var(--warning-light);
            text-decoration: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .toggle-form a:hover {
            text-decoration: none;
            color: var(--warning);
            transform: translateX(5px);
        }

        .toggle-form a::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 100%;
            height: 2px;
            background: var(--warning);
            transition: right 0.3s;
        }

        .toggle-form a:hover::after {
            right: 0;
        }

        .message {
            padding: 16px;
            border-radius: 12px;
            margin-bottom: 25px;
            text-align: center;
            display: none;
            font-size: 14px;
            font-weight: 500;
            border: 1px solid transparent;
            position: relative;
            overflow: hidden;
            animation: slideDown 0.4s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 40%, rgba(255, 255, 255, 0.05) 100%);
        }

        .message i {
            margin-right: 10px;
            font-size: 1.2rem;
        }

        .success {
            background: rgba(0, 200, 83, 0.15);
            color: var(--success);
            border-color: rgba(0, 200, 83, 0.3);
        }

        .error {
            background: rgba(244, 67, 54, 0.15);
            color: var(--danger);
            border-color: rgba(244, 67, 54, 0.3);
        }

        .warning {
            background: rgba(255, 152, 0, 0.15);
            color: var(--warning);
            border-color: rgba(255, 152, 0, 0.3);
        }

        .info {
            background: rgba(33, 150, 243, 0.15);
            color: var(--info);
            border-color: rgba(33, 150, 243, 0.3);
        }

        .banned {
            background: rgba(244, 67, 54, 0.2);
            color: var(--danger);
            border-color: rgba(244, 67, 54, 0.4);
            border-left: 4px solid var(--danger);
        }

        .loader {
            display: none;
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-top: 3px solid var(--warning);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 25px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .form-tabs {
            display: flex;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 5px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .form-tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            font-weight: 600;
            color: var(--gray-light);
            border-radius: 10px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .form-tab:hover {
            color: var(--white);
            background: rgba(255, 255, 255, 0.1);
        }

        .form-tab.active {
            color: var(--white);
            background: var(--gradient-warning);
            box-shadow: 0 5px 15px rgba(255, 152, 0, 0.3);
        }

        .form-tab i {
            font-size: 1.1rem;
        }

        .hidden {
            display: none;
        }

        .admin-note {
            background: rgba(33, 150, 243, 0.1);
            border-left: 4px solid var(--info);
            padding: 16px;
            margin: 20px 0;
            border-radius: 10px;
            font-size: 13px;
            color: var(--gray-light);
            position: relative;
            overflow: hidden;
        }

        .admin-note::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 40%, rgba(255, 255, 255, 0.03) 100%);
        }

        .admin-note i {
            color: var(--info);
            margin-right: 10px;
            font-size: 1.1rem;
            position: relative;
            z-index: 1;
        }

        .admin-note strong {
            color: var(--white);
            position: relative;
            z-index: 1;
        }

        .admin-note p {
            margin-top: 8px;
            line-height: 1.5;
            position: relative;
            z-index: 1;
        }

        .welcome-note {
            background: rgba(0, 200, 83, 0.1);
            border-left: 4px solid var(--success);
            padding: 18px;
            margin: 20px 0;
            border-radius: 10px;
            font-size: 14px;
            color: var(--success-light);
            position: relative;
            overflow: hidden;
            animation: fadeIn 0.6s ease-out;
        }

        .welcome-note::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 40%, rgba(255, 255, 255, 0.03) 100%);
        }

        .welcome-note i {
            color: var(--success);
            margin-right: 12px;
            font-size: 1.2rem;
            position: relative;
            z-index: 1;
        }

        .welcome-note span {
            position: relative;
            z-index: 1;
            font-weight: 500;
        }

        .no-invite-option {
            margin-top: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .no-invite-option a {
            color: var(--warning-light);
            text-decoration: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .no-invite-option a:hover {
            color: var(--warning);
            transform: translateX(5px);
        }

        .no-invite-option a i {
            font-size: 0.9rem;
        }

        /* Responsive */
        @media (max-width: 480px) {
            .container {
                padding: 10px;
            }
            
            .card {
                padding: 25px;
            }
            
            .logo h1 {
                font-size: 1.6rem;
            }
            
            .bonus-badge {
                padding: 12px 20px;
                font-size: 0.9rem;
            }
            
            .form-title {
                font-size: 1.3rem;
            }
            
            .form-tab {
                padding: 12px 8px;
                font-size: 0.9rem;
            }
        }

        /* Banned User Modal */
        .banned-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 2000;
            display: none;
            justify-content: center;
            align-items: center;
            padding: 20px;
            backdrop-filter: blur(10px);
        }

        .banned-content {
            background: var(--dark-card);
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 100%;
            text-align: center;
            border: 1px solid rgba(244, 67, 54, 0.3);
            box-shadow: 0 20px 60px rgba(244, 67, 54, 0.2);
            position: relative;
            overflow: hidden;
            animation: modalSlide 0.5s ease-out;
        }

        @keyframes modalSlide {
            from { opacity: 0; transform: translateY(-40px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        .banned-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 20% 80%, rgba(244, 67, 54, 0.1) 0%, transparent 50%);
        }

        .banned-icon {
            font-size: 4rem;
            color: var(--danger);
            margin-bottom: 20px;
            animation: shake 0.8s ease-in-out infinite;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .banned-content h2 {
            color: var(--danger);
            margin-bottom: 15px;
            font-size: 1.8rem;
        }

        .banned-content p {
            color: var(--gray-light);
            margin-bottom: 25px;
            line-height: 1.6;
            font-size: 1rem;
        }

        .banned-details {
            background: rgba(244, 67, 54, 0.1);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: left;
            border: 1px solid rgba(244, 67, 54, 0.2);
        }

        .banned-details h4 {
            color: var(--danger);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .banned-details ul {
            list-style: none;
            padding-left: 10px;
        }

        .banned-details li {
            color: var(--gray-light);
            margin-bottom: 8px;
            padding-left: 20px;
            position: relative;
        }

        .banned-details li::before {
            content: '•';
            color: var(--danger);
            position: absolute;
            left: 0;
        }

        .support-btn {
            background: var(--gradient-primary);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-top: 15px;
        }

        .support-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(26, 35, 126, 0.3);
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Banned User Modal -->
    <div id="bannedModal" class="banned-modal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.6); align-items:center; justify-content:center;">
        <div class="banned-content" style="background:#fff; padding:20px; border-radius:8px; max-width:480px; width:90%;">
            <div class="banned-icon" style="font-size:32px; color:#c0392b; text-align:center;">
                <i class="fas fa-ban"></i>
            </div>
            <h2>Conta Suspensa</h2>
            <p>Sua conta foi temporariamente suspensa devido a violação dos nossos termos de serviço.</p>
            <div class="banned-details">
                <h4><i class="fas fa-exclamation-triangle"></i> Detalhes da Suspensão</h4>
                <ul>
                    <li><strong>Motivo:</strong> Violação dos Termos de Serviço</li>
                    <li><strong>Suspensão até:</strong> <span id="banEndDate">Data não especificada</span></li>
                    <li><strong>Razão:</strong> <span id="banReason">Não especificada</span></li>
                    <li><strong>Código da Infração:</strong> <span id="banCode">000-000</span></li>
                </ul>
            </div>
            <p>Para apelar desta decisão ou obter mais informações, entre em contato com nosso suporte.</p>
            <button class="support-btn" onclick="contactSupport()"> <i class="fab fa-telegram"></i> Contactar Suporte</button>
        </div>
    </div>

    <div class="container">
        <div class="logo">
            <h1><i class="fas fa-chart-line"></i> Nzila Hub</h1>
            <p>Sistema de Rentabilidade • Segurança Garantida</p>
        </div>

        <div class="bonus-badge">
            <i class="fas fa-gift"></i>
            <span>BÓNUS AUTOMÁTICO: 200 Kz na conta!</span>
        </div>

        <div class="card">
            <div id="message" class="message"></div>
            <div id="loader" class="loader"></div>

            <div class="form-tabs">
                <div class="form-tab active" id="loginTab" onclick="showForm('login')">
                    <i class="fas fa-sign-in-alt"></i> Login
                </div>
                <div class="form-tab" id="signupTab" onclick="showForm('signup')">
                    <i class="fas fa-user-plus"></i> Cadastro
                </div>
            </div>

            <!-- Login Form -->
            <div id="loginForm" class="form-container">
                <h2 class="form-title"><i class="fas fa-sign-in-alt"></i> Entrar na Conta</h2>

                <div class="welcome-note">
                    <i class="fas fa-info-circle"></i>
                    <span>Bem-vindo de volta! Aceda à sua conta para gerir investimentos.</span>
                </div>

                <form id="loginFormFields" onsubmit="handleLogin(event)">
                    <div class="form-group">
                        <label for="loginPhone"><i class="fas fa-phone"></i> Número de Telefone</label>
                        <div class="input-with-icon">
                            <i class="fas fa-phone-alt"></i>
                            <input type="tel" id="loginPhone" required placeholder="9XX XXX XXX">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="loginPassword"><i class="fas fa-lock"></i> Senha (6 dígitos)</label>
                        <div class="input-with-icon">
                            <i class="fas fa-key"></i>
                            <input type="password" id="loginPassword" required maxlength="6" pattern="\d{6}" placeholder="Apenas 6 dígitos">
                        </div>
                        <span class="password-rules">Digite sua senha de 6 dígitos</span>
                    </div>

                    <button type="submit" class="submit-btn" id="loginBtn">
                        <i class="fas fa-sign-in-alt"></i> <span>Entrar na Conta</span>
                    </button>
                </form>

                <div class="toggle-form">
                    Não tem conta? <a onclick="showForm('signup')">Crie uma conta agora</a>
                </div>
            </div>

            <!-- Signup Form -->
            <div id="signupForm" class="form-container hidden">
                <h2 class="form-title"><i class="fas fa-user-plus"></i> Criar Nova Conta</h2>

                <div class="welcome-note">
                    <i class="fas fa-handshake"></i>
                    <span>Junte-se à nossa comunidade de investidores! Bónus de 200 Kz ao registar-se.</span>
                </div>

                <form id="signupFormFields" onsubmit="handleSignup(event)">
                    <div class="form-group">
                        <label for="fullName"><i class="fas fa-user"></i> Nome Completo</label>
                        <div class="input-with-icon">
                            <i class="fas fa-user-circle"></i>
                            <input type="text" id="fullName" required placeholder="Digite seu nome completo">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="phone"><i class="fas fa-phone"></i> Número de Telefone</label>
                        <div class="input-with-icon">
                            <i class="fas fa-mobile-alt"></i>
                            <input type="tel" id="phone" required placeholder="9XX XXX XXX">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="password"><i class="fas fa-lock"></i> Senha (6 dígitos)</label>
                        <div class="input-with-icon">
                            <i class="fas fa-lock"></i>
                            <input type="password" id="password" required maxlength="6" pattern="\d{6}" placeholder="Apenas 6 dígitos">
                        </div>
                        <span class="password-rules">A senha deve conter exatamente 6 dígitos numéricos</span>
                    </div>

                    <div class="form-group">
                        <label for="inviteCode"><i class="fas fa-user-friends"></i> Código de Convite <span class="optional">(Opcional - se não tiver, deixe em branco)</span></label>
                        <div class="input-with-icon">
                            <i class="fas fa-envelope"></i>
                            <input type="text" id="inviteCode" placeholder="Digite o código do convite (opcional)">
                        </div>
                    </div>

                    <div class="admin-note">
                        <i class="fas fa-exclamation-circle"></i>
                        <div>
                            <strong>Sem código de convite?</strong>
                            <p>Não tem problema! Você pode criar conta sem código. Nossa equipe irá atribuir um agente para acompanhá-lo e você terá acesso completo à plataforma.</p>
                        </div>
                    </div>

                    <button type="submit" class="submit-btn" id="signupBtn">
                        <i class="fas fa-user-plus"></i> <span>Criar Conta Agora</span>
                    </button>
                </form>

                <div class="toggle-form">
                    Já tem conta? <a onclick="showForm('login')">Faça login aqui</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Script usando módulos Firebase (v9 modular) -->
    <script type="module">
        // Imports (Auth + Realtime Database modular)
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
        import {
            getDatabase,
            ref,
            get,
            set,
            update,
            query,
            orderByChild,
            equalTo,
            limitToFirst
        } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";
        import {
            getAuth,
            createUserWithEmailAndPassword,
            signInWithEmailAndPassword,
            signOut
        } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";

        // === Substitua apenas o firebaseConfig abaixo pelo seu novo Firebase (já colocado conforme solicitado) ===
        const firebaseConfig = {
            apiKey: "AIzaSyAhgQ2C7d1rXp9swiACYR1dwgeX7z3n3ew",
            authDomain: "blue-a110c.firebaseapp.com",
            databaseURL: "https://blue-a110c-default-rtdb.firebaseio.com",
            projectId: "blue-a110c",
            storageBucket: "blue-a110c.firebasestorage.app",
            messagingSenderId: "828500064328",
            appId: "1:828500064328:web:8b92e0279789061feec07d"
        };

        // Initialize Firebase (modular)
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getDatabase(app);

        // === Utility helper functions and application logic ===

        // Get URL parameters for referral code
        function getUrlParameter(name) {
            name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
            var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
            var results = regex.exec(location.search);
            return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
        }

        // Show banned user modal
        function showBannedModal(banData) {
            const modal = document.getElementById('bannedModal');
            const endDate = banData.endDate ? new Date(banData.endDate).toLocaleDateString('pt-AO') : 'Indeterminada';
            const reason = banData.reason || 'Violação dos Termos de Serviço';
            const code = banData.code || '001-BAN';

            document.getElementById('banEndDate').textContent = endDate;
            document.getElementById('banReason').textContent = reason;
            document.getElementById('banCode').textContent = code;

            modal.style.display = 'flex';

            // Prevent closing the modal by clicking on backdrop
            modal.onclick = function(e) {
                if (e.target === modal) {
                    return false;
                }
            };
        }

        // Contact support function (exponho globalmente mais abaixo)
        function contactSupport() {
            window.open('https://t.me/Sensohumor', '_blank');
        }

        // Check if user is banned (Realtime Database)
        async function checkIfUserBanned(userId) {
            try {
                const snapshot = await get(ref(db, `users/${userId}`));
                if (snapshot.exists()) {
                    const userData = snapshot.val();

                    if (userData.status === 'banned' || userData.isBanned === true) {
                        const banData = {
                            endDate: userData.banEndDate || null,
                            reason: userData.banReason || 'Violação dos Termos de Serviço',
                            code: userData.banCode || '001-BAN'
                        };

                        // Sign out the user
                        await signOut(auth);

                        // Show banned modal
                        setTimeout(() => {
                            showBannedModal(banData);
                        }, 500);

                        return true;
                    }
                }
                return false;
            } catch (error) {
                console.error('Error checking user ban status:', error);
                return false;
            }
        }

        function showForm(formType) {
            const loginForm = document.getElementById('loginForm');
            const signupForm = document.getElementById('signupForm');
            const loginTab = document.getElementById('loginTab');
            const signupTab = document.getElementById('signupTab');

            if (window.switchFormTimeout) {
                clearTimeout(window.switchFormTimeout);
            }

            if (formType === 'login') {
                loginForm.classList.remove('hidden');
                signupForm.classList.add('hidden');
                loginTab.classList.add('active');
                signupTab.classList.remove('active');
            } else {
                loginForm.classList.add('hidden');
                signupForm.classList.remove('hidden');
                loginTab.classList.remove('active');
                signupTab.classList.add('active');

                window.switchFormTimeout = setTimeout(() => {
                    checkReferralCode();
                }, 100);
            }
        }

        function showMessage(text, type) {
            const messageDiv = document.getElementById('message');

            if (messageDiv.textContent === text && messageDiv.style.display === 'block') {
                return;
            }

            messageDiv.textContent = text;
            messageDiv.className = `message ${type || ''}`;
            messageDiv.style.display = 'block';

            if (type === 'info' || type === 'warning') {
                setTimeout(() => {
                    if (messageDiv.textContent === text) {
                        messageDiv.style.display = 'none';
                    }
                }, 5000);
            }
        }

        function showLoader(show) {
            const el = document.getElementById('loader');
            if (el) el.style.display = show ? 'block' : 'none';
        }

        function disableButton(buttonId, disable) {
            const button = document.getElementById(buttonId);
            if (button) {
                button.disabled = disable;
                const icon = buttonId === 'loginBtn' ? 'fa-sign-in-alt' : 'fa-user-plus';
                const text = buttonId === 'loginBtn' ? 'Entrar na Conta' : 'Criar Conta Agora';

                button.innerHTML = disable ?
                    `<i class="fas fa-spinner fa-spin"></i> <span>Processando...</span>` :
                    `<i class="fas ${icon}"></i> <span>${text}</span>`;
            }
        }

        function generateAgentCode() {
            return Math.floor(100000 + Math.random() * 900000).toString();
        }

        // Check referral code — first try agentCodes index, then fallback to query users by agentCode
        async function validateReferralCode(referralCode) {
            if (!referralCode || referralCode.trim() === '') {
                return { valid: false, message: 'Sem código de convite' };
            }

            try {
                // Try agentCodes index
                const agentSnap = await get(ref(db, `agentCodes/${referralCode.trim()}`));
                if (agentSnap.exists()) {
                    const referrerId = agentSnap.val();
                    const referrerSnap = await get(ref(db, `users/${referrerId}`));
                    if (referrerSnap.exists()) {
                        const referrerData = referrerSnap.val();
                        if (referrerData.status === 'banned' || referrerData.isBanned === true) {
                            return {
                                valid: false,
                                message: 'Este referente está temporariamente indisponível. Use outro código ou deixe em branco.'
                            };
                        }
                        return {
                            valid: true,
                            referrerId,
                            referrerData,
                            message: 'Código de convite válido!'
                        };
                    }
                }

                // Fallback: query users by agentCode
                const usersQuery = query(ref(db, 'users'), orderByChild('agentCode'), equalTo(referralCode.trim()), limitToFirst(1));
                const usersSnap = await get(usersQuery);
                if (!usersSnap.exists()) {
                    return { valid: false, message: 'Código de convite inválido ou não encontrado' };
                }

                let foundKey = null;
                let foundData = null;
                usersSnap.forEach(child => {
                    foundKey = child.key;
                    foundData = child.val();
                });

                if (foundData.status === 'banned' || foundData.isBanned === true) {
                    return {
                        valid: false,
                        message: 'Este referente está temporariamente indisponível. Use outro código ou deixe em branco.'
                    };
                }

                return {
                    valid: true,
                    referrerId: foundKey,
                    referrerData: foundData,
                    message: 'Código de convite válido!'
                };

            } catch (error) {
                console.error('Error validating referral code:', error);
                return {
                    valid: false,
                    message: 'Erro ao verificar código de convite'
                };
            }
        }

        // Register referred friend by creating an entry under users/{referrerId}/friends/registered/{inviteeId}
        async function registerReferredFriend(inviteeId, inviteeData, referrerId) {
            try {
                const friendData = {
                    userId: inviteeId,
                    phone: inviteeData.phone,
                    name: inviteeData.fullName,
                    date: new Date().toISOString(),
                    agentCode: inviteeData.agentCode,
                    status: 'registered',
                    hasInvested: false
                };
                await set(ref(db, `users/${referrerId}/friends/registered/${inviteeId}`), friendData);
                console.log(`✅ Amigo ${inviteeId} registrado para referente ${referrerId}`);
                return true;
            } catch (error) {
                console.error('Error registering referred friend:', error);
                return false;
            }
        }

        // Get referral code from url and populate inviteCode input when signup form shows
        function checkReferralCode() {
            const refCode = getUrlParameter('ref');
            if (refCode) {
                const inviteInput = document.getElementById('inviteCode');
                if (inviteInput && !inviteInput.value) {
                    inviteInput.value = refCode;

                    if (!document.getElementById('signupForm').classList.contains('hidden')) {
                        if (!window.refCodeMessageShown) {
                            showMessage(`Código de convite "${refCode}" preenchido automaticamente!`, 'info');
                            window.refCodeMessageShown = true;
                            setTimeout(() => {
                                const messageDiv = document.getElementById('message');
                                if (messageDiv && messageDiv.textContent.includes('Código de convite')) {
                                    messageDiv.style.display = 'none';
                                }
                            }, 3000);
                        }
                    }
                }
            }
        }

        // Login handler (modular auth)
        async function handleLogin(event) {
            event.preventDefault();

            const phone = document.getElementById('loginPhone').value.replace(/\s/g, '');
            const password = document.getElementById('loginPassword').value;

            if (!phone.match(/^9\d{8}$/)) {
                showMessage('Número de telefone inválido. Deve começar com 9 e ter 9 dígitos', 'error');
                return;
            }

            if (!/^\d{6}$/.test(password)) {
                showMessage('A senha deve conter exatamente 6 dígitos numéricos', 'error');
                return;
            }

            showLoader(true);
            disableButton('loginBtn', true);

            try {
                const email = `${phone}@economia.com`;
                const userCredential = await signInWithEmailAndPassword(auth, email, password);

                // Check ban status
                const isBanned = await checkIfUserBanned(userCredential.user.uid);

                if (isBanned) {
                    showLoader(false);
                    disableButton('loginBtn', false);
                    return;
                }

                showMessage('Login realizado com sucesso! Redirecionando...', 'success');

                // Check user status before redirect
                const userSnap = await get(ref(db, `users/${userCredential.user.uid}`));
                const userData = userSnap.exists() ? userSnap.val() : null;

                if (userData && userData.status === 'active') {
                    setTimeout(() => {
                        window.location.href = 'index.html';
                    }, 2000);
                } else {
                    showMessage('Sua conta está sob análise. Contacte o suporte.', 'warning');
                }

            } catch (error) {
                let errorMessage = 'Erro ao fazer login. ';
                const code = error.code || '';
                switch (code) {
                    case 'auth/user-not-found':
                        errorMessage = 'Usuário não encontrado. Crie uma conta primeiro.';
                        break;
                    case 'auth/wrong-password':
                        errorMessage = 'Senha incorreta. Tente novamente.';
                        break;
                    case 'auth/invalid-email':
                        errorMessage = 'Email inválido.';
                        break;
                    case 'auth/user-disabled':
                        errorMessage = 'Esta conta foi desativada. Contacte o suporte.';
                        break;
                    case 'auth/too-many-requests':
                        errorMessage = 'Muitas tentativas. Tente novamente mais tarde.';
                        break;
                    default:
                        errorMessage += (error.message || '');
                }
                showMessage(errorMessage, 'error');
            } finally {
                showLoader(false);
                disableButton('loginBtn', false);
            }
        }

        // Signup handler (modular auth + RTDB)
        async function handleSignup(event) {
            event.preventDefault();

            const fullName = document.getElementById('fullName').value.trim();
            const phone = document.getElementById('phone').value.replace(/\s/g, '');
            const password = document.getElementById('password').value;
            const inviteCode = document.getElementById('inviteCode').value.trim();

            if (!fullName) {
                showMessage('Por favor, digite seu nome completo', 'error');
                return;
            }

            if (!phone.match(/^9\d{8}$/)) {
                showMessage('Número de telefone inválido. Deve começar com 9 e ter 9 dígitos', 'error');
                return;
            }

            if (!/^\d{6}$/.test(password)) {
                showMessage('A senha deve conter exatamente 6 dígitos numéricos', 'error');
                return;
            }

            showLoader(true);
            disableButton('signupBtn', true);

            try {
                const email = `${phone}@economia.com`;

                // First check if user already exists by attempting sign in with dummy password
                try {
                    await signInWithEmailAndPassword(auth, email, "dummy");
                    showMessage('Este número de telefone já está registado. Faça login em vez disso.', 'error');
                    showLoader(false);
                    disableButton('signupBtn', false);
                    return;
                } catch (authError) {
                    // Expecting sign-in failure for non-existing users; continue to create
                }

                let referrerId = null;
                let referrerCode = null;
                let validInviteCode = false;

                if (inviteCode) {
                    const validationResult = await validateReferralCode(inviteCode);

                    if (validationResult.valid) {
                        referrerId = validationResult.referrerId;
                        referrerCode = inviteCode;
                        validInviteCode = true;
                        showMessage(validationResult.message, 'success');
                    } else {
                        showMessage(`${validationResult.message}. Você ainda pode criar conta.`, 'warning');
                        referrerCode = 'SYSTEM';
                    }
                } else {
                    referrerCode = 'SYSTEM';
                }

                // Create user with email/password
                const userCredential = await createUserWithEmailAndPassword(auth, email, password);
                const user = userCredential.user;
                const agentCode = generateAgentCode();

                const userData = {
                    fullName: fullName,
                    phone: phone,
                    agentCode: agentCode,
                    referredBy: referrerCode,
                    balance: 200,
                    createdAt: new Date().toISOString(),
                    earnings: {
                        today: 0,
                        total: 0,
                        commission: 0,
                        investment: 0,
                        subsidies: 0
                    },
                    friends: {
                        invested: {},
                        registered: {}
                    },
                    investments: {},
                    withdrawals: {},
                    deposits: {},
                    commissions: {},
                    dailyEarnings: {},
                    hasInvestedBefore: false,
                    bankAccounts: {},
                    status: 'active',
                    isBanned: false,
                    lastLogin: new Date().toISOString()
                };

                // Write user data to Realtime Database
                await set(ref(db, `users/${user.uid}`), userData);

                // Create agentCodes index for quick lookup
                await set(ref(db, `agentCodes/${agentCode}`), user.uid);

                // If referrer exists, register friend
                if (validInviteCode && referrerId) {
                    await registerReferredFriend(user.uid, userData, referrerId);
                }

                const successMessage = `✅ Conta criada com sucesso! Seu código de agente é: ${agentCode}`;
                showMessage(successMessage, 'success');

                // Auto login after successful signup
                setTimeout(async () => {
                    try {
                        await signInWithEmailAndPassword(auth, email, password);
                        window.location.href = 'index.html';
                    } catch (loginError) {
                        console.log('Auto-login error:', loginError);
                        showMessage('Conta criada! Faça login manualmente.', 'info');
                        showForm('login');
                        document.getElementById('loginPhone').value = phone;
                    }
                }, 3000);

            } catch (error) {
                let errorMessage = 'Erro ao criar conta. ';
                const code = error.code || '';
                switch (code) {
                    case 'auth/email-already-in-use':
                        errorMessage = 'Este telefone já está registado. Faça login.';
                        break;
                    case 'auth/weak-password':
                        errorMessage = 'Senha muito fraca. Use 6 dígitos.';
                        break;
                    case 'auth/invalid-email':
                        errorMessage = 'Email inválido.';
                        break;
                    case 'auth/operation-not-allowed':
                        errorMessage = 'Operação não permitida. Contacte o suporte.';
                        break;
                    default:
                        errorMessage += (error.message || '');
                }
                showMessage(errorMessage, 'error');
            } finally {
                showLoader(false);
                disableButton('signupBtn', false);
            }
        }

        // Format phone number
        function formatPhoneNumber(input) {
            let value = input.value.replace(/\D/g, '');
            if (value.length > 9) value = value.substring(0, 9);
            if (value.length > 0) {
                value = value.replace(/^(\d{3})(\d{3})(\d{3})$/, '$1 $2 $3');
            }
            input.value = value;
        }

        // Initialize event listeners after DOM loaded
        document.addEventListener('DOMContentLoaded', function() {
            window.refCodeMessageShown = false;
            window.switchFormTimeout = null;

            checkReferralCode();

            const phoneInputs = document.querySelectorAll('input[type="tel"]');
            phoneInputs.forEach(input => {
                input.addEventListener('input', function() {
                    formatPhoneNumber(this);
                });
            });

            const passwordInputs = document.querySelectorAll('input[type="password"][maxlength="6"]');
            passwordInputs.forEach(input => {
                input.addEventListener('input', function() {
                    this.value = this.value.replace(/\D/g, '').substring(0, 6);
                });
            });

            const inviteEl = document.getElementById('inviteCode');
            if (inviteEl) {
                inviteEl.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                    }
                });
            }

            // Add animation delays and floating effect as in original code
            const formGroups = document.querySelectorAll('.form-group');
            formGroups.forEach((group, index) => {
                group.style.animationDelay = `${index * 0.1}s`;
            });

            const card = document.querySelector('.card');
            if (card) {
                setInterval(() => {
                    card.style.transform = `translateY(${Math.sin(Date.now() / 2000) * 5}px)`;
                }, 50);
            }

            // Close message when clicking on it
            const messageEl = document.getElementById('message');
            if (messageEl) {
                messageEl.addEventListener('click', function() {
                    this.style.display = 'none';
                });
            }
        });

        // Expose a few functions to global scope so inline onclick/onsubmit attributes keep working
        window.handleLogin = handleLogin;
        window.handleSignup = handleSignup;
        window.showForm = showForm;
        window.contactSupport = contactSupport;
        window.checkReferralCode = checkReferralCode;
        window.formatPhoneNumber = formatPhoneNumber;
    </script>
</body>
</html>